<%= javascript_pack_tag 'users' %>
<div class="container text-white my-4">
  <div class="row">
    <div class="col mx-auto">
      <div class="row">
        <div class="col-5 col-sm-4 col-md-3 col-lg-2">
          <% if @user.avatar.attached? %>
            <%= image_tag @user.avatar, alt: "user avatar", class: "image-shape" %>
          <% end %>
          <% if current_user == @user %>
            <%= form_tag user_avatars_path(@user), multipart: true do %>
                <%= file_field_tag :avatar, class: "clickable-pp" %>
                <div class="avatar-effect"></div>
            <% end %>
          <% end %>
        </div>
        <div class="col-7 col-sm-8 col-md-9 col-lg-10">
          <% if @user.rank == 0 || @user.rank == 2 %>
            <p class="h1"><strong><%= @user.username %> <i class="fas fa-check-circle"></i></strong></p>
            <% else %>
            <p class="h1"><strong><%= @user.username %></strong></p>
          <% end %>
          <% if current_user == @user %>
            <p> <%= button_to "Edit profile", edit_user_registration_path, :method => "get", class: "btn btn-secondary btn-sm" %></p>
          <% end %>
          <% if current_user.rank == 0 %>
            <p> <%= button_to "Delete profile", user_path(@user), method: :delete, class: "btn btn-danger btn-sm" %></p>
            <%= form_with model: @user do |f| %>
              <div class="btn-group">
                <%= f.select :rank, [["Admin", 0],["Regular", 1],["Validated", 2]], class: "select-rank" %>
                <%= f.submit "Change rank", class: "btn btn-danger btn-sm" %>
              </div>
            <%  end %>
          <% end %>
        </div>
      </div>
      <div class="row movies-review">
        <div class="col-8 mx-auto text-center">
          <p class="my-4"> Movies reviewed : <%= @notations.count %></p>
        </div>
      </div>
      <div class="row">
        <div class="col"><br>
          <p class="h4" >Last reviews:</p>
          <ul>
          <% @notations.each do |notation| %>
            <li class="h3"><%= notation.movie.title %></li>
            <div class="text-right pt-3 user-rate text-center js-notation">
              <%=image_tag notation.movie.image_url, :class => 'movie-poster' %>
              <%= form_with do |f| %>
                <%= f.label :scenario, "Scenario" %>
                <%= f.range_field :scenario, :in => 0..100, :step => 1, value:notation.criteria_review("scenario"), :disabled => true  %><br>
                <%= f.label :image, "Image" %>
                <%= f.range_field :image, :in => 0..100, :step => 1, value:notation.criteria_review("image"), :disabled => true %><br>
                <%= f.label :editing, "Editing" %>
                <%= f.range_field :editing, :in => 0..100, :step => 1, value:notation.criteria_review("editing"), :disabled => true %><br>
                <%= f.label :sound, "Sound" %>
                <%= f.range_field :sound, :in => 0..100, :step => 1, value:notation.criteria_review("sound"), :disabled => true %><br>
                <%= f.label :makeup, "Makeup" %>
                <%= f.range_field :makeup, :in => 0..100, :step => 1, value:notation.criteria_review("makeup"), :disabled => true %><br>
                <%= f.label :directing, "Directing" %>
                <%= f.range_field :directing, :in => 0..100, :step => 1, value:notation.criteria_review("directing"), :disabled => true %><br>
              <% end %>
            </div>
          <hr>
          <% end %>
        </ul>
        </div>
      </div>
  </div>
</div>
<%= javascript_pack_tag 'user_notations' %>
